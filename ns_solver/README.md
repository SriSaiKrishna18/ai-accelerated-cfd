# Proper Incompressible Navier-Stokes Solver + AI Surrogate

## Architecture

```
ns_solver/
  ns_solver.cpp    <-- C++ HPC solver (fast, OpenMP parallel)
  ns_solver.py     <-- Python NS solver (reference only, very slow)
  train_ai.py      <-- Python AI training & validation
  data/            <-- Binary state files (generated by C++ solver)
  results/         <-- AI validation output
```

**Design**: HPC in C++ (50-100x faster than Python for Poisson solver), AI in Python (PyTorch).

## Method: Chorin's Projection

1. **Predictor**: u* = u^n + dt*(-u.grad(u) + nu*laplacian(u))
2. **Pressure Poisson**: laplacian(p) = (1/dt)*div(u*) -- Red-Black SOR
3. **Corrector**: u^{n+1} = u* - dt*grad(p)

Target: div(u) < 1e-6 (proper incompressible flow)

## Build & Run

```bash
# Compile with OpenMP
g++ -O3 -fopenmp -o ns_solver ns_solver.cpp -lm

# Quick validation (32x32, 200 steps)
./ns_solver

# Generate AI training data (21 cases)
./ns_solver sweep 0.1 1.0 21 200 64

# Train AI on the data
python train_ai.py
```

## vs Simplified Solver

| Property | Simplified (src/) | Proper (ns_solver/) |
|----------|-------------------|---------------------|
| Language | C++/Python | C++ (HPC) + Python (AI) |
| Method | Euler (no projection) | Chorin's projection |
| div(u) | ~10-30 | < 1e-6 |
| Physics | Approximate | Incompressible |
| Pressure | Random noise | Poisson-converged |
